<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
    </head>
    <body>
        <form id="form" novalidate>
            Imie:<br> <input type="text" id="name"><br>
            <span class="error"></span><br>
            Nazwisko:<br> <input type="text" id="surname"><br>
            <span class="error"></span><br>
            Email:<br> <input type="text" id="email"><br>
            <span class="error"></span><br>
            Hasło:<br> <input type="password" id="password"><br>
            <span class="error"></span><br>
            Płeć:<br> M<input type="radio" id="m" name="sex" value="m" checked> K<input type="radio" id="k" name="sex" value="k"><br>
            <span class="error"></span><br>
            Telefon:<br> <input type="number" id="phone"><br>
            <span class="error"></span><br>
            Data urodzenia:<br> <input type="date" id="birthday"><br>
            <span class="error"></span><br>
            Kraj:<br> <input type="text" id="country"><br>
            <span class="error"></span><br>
            <button type="submit">Zapisz</button>
        </form>
        <style>
            body {
                text-align: center;
            }
            
            input {
                border-radius: 20px 100%;
            }

        </style>
        <script>
            // funkcja sprawdzająca czy pole posiada wartość
            function validateRequiredField(fieldValue) {
            if (fieldValue.trim() === '') {
                return false;
            } else {
                return true;
            }
            }

            // funkcja sprawdzająca długość znaków
            function validateLength(fieldValue, minLength, maxLength) {
            if (fieldValue.length < minLength || fieldValue.length > maxLength) {
                return false;
            } else {
                return true;
            }
            }

            // funkcja sprawdzająca poprawność adresu email
            function validateEmail(email) {
            const emailRegex = /[a-zA-Z]+.{5,}@[a-zA-Z]+.{2,}\.[a-zA-Z]{2,5}/;
            return emailRegex.test(email);
            }

            // funkcja sprawdzająca trudność hasła
            function validatePassword(password) {
            const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;
            return passwordRegex.test(password);
            }

            // funkcja wywoływana przy submicie formularza
            function validateForm(event) {
            event.preventDefault(); // zatrzymuje standardową akcję submitowania formularza

            // pobieranie wartości pól formularza
            let name = document.getElementById('name');
            let surname = document.getElementById('surname');
            let email = document.getElementById('email');
            let password = document.getElementById('password');
            let sex = "";
            if (document.getElementById('m').checked) {
                sex = "m";
            } else {
                sex = "k";
            }
            let phone = document.getElementById('phone');
            let birthday = document.getElementById('birthday');
            let country = document.getElementById('country');
            let correctForm = true;

            // walidacja pól formularza
            if (!validateRequiredField(name.value)) {
                document.getElementsByClassName("error")[0].innerHTML = "Pole Imię jest wymagane!";
                // name.setCustomValidity('Uzupełnij polę Imię'); // Wszelkie zakomentowane rzeczy w "if'ach" to zadanie 2
                // name.reportValidity('');
                correctForm = false;
                return;
            } else {
                document.getElementsByClassName("error")[0].innerHTML = "";
            }

            if (!validateRequiredField(surname.value)) {
                document.getElementsByClassName("error")[1].innerHTML = "Pole Nazwisko jest wymagane!";
                // surname.setCustomValidity('Pole Nazwisko jest wymagane!');
                // surname.reportValidity('');
                correctForm = false;
                return;
            } else {
                document.getElementsByClassName("error")[1].innerHTML = "";
            }

            if (!validateRequiredField(email.value)) {
                document.getElementsByClassName("error")[2].innerHTML = "Pole Email jest wymagane!";
                // email.setCustomValidity('Pole Email jest wymagane!');
                // email.reportValidity('');
                correctForm = false;
                return;
            } else {
                document.getElementsByClassName("error")[2].innerHTML = "";
            }

            if (!validateEmail(email.value)) {
                document.getElementsByClassName("error")[2].innerHTML = "Podaj poprawny adres email!";
                // email.setCustomValidity('Podaj poprawny adres email!');
                // email.reportValidity('');
                correctForm = false;
                return;
            } else {
                document.getElementsByClassName("error")[2].innerHTML = "";
            }

            if (!validateRequiredField(password.value)) {
                document.getElementsByClassName("error")[3].innerHTML = "Pole Hasło jest wymagane!";
                // password.setCustomValidity('Pole Hasło jest wymagane!');
                // password.reportValidity('');
                correctForm = false;
                return;
            } else {
                document.getElementsByClassName("error")[3].innerHTML = "";
            }

            if (!validatePassword(password.value)) {
                document.getElementsByClassName("error")[3].innerHTML = "Hasło musi mieć co najmniej 8 znaków, zawierać co najmniej jedną małą literę, jedną wielką literę i jedną cyfrę!";
                // password.setCustomValidity('Hasło musi mieć co najmniej 8 znaków, zawierać co najmniej jedną małą literę, jedną wielką literę i jedną cyfrę!');
                // password.reportValidity('');
                correctForm = false;
                return;
            } else {
                document.getElementsByClassName("error")[3].innerHTML = "";
            }

            if (!validateRequiredField(sex)) {
                document.getElementsByClassName("error")[4].innerHTML = "Pole Płeć jest wymagane!";
                // sex.setCustomValidity('Pole Płeć jest wymagane!');
                // sex.reportValidity('');
                correctForm = false;
                return;
            } else {
                document.getElementsByClassName("error")[4].innerHTML = "";
            }

            if (!validateRequiredField(phone.value)) {
                document.getElementsByClassName("error")[5].innerHTML = "Pole Telefon jest wymagane!";
                // phone.setCustomValidity('Pole Telefon jest wymagane!');
                // phone.reportValidity('');
                correctForm = false;
                return;
            } else {
                document.getElementsByClassName("error")[5].innerHTML = "";
            }

            if (!validateRequiredField(birthday.value)) {
                document.getElementsByClassName("error")[6].innerHTML = "Pole Data urodzenia jest wymagane!";
                // birthday.setCustomValidity('Pole Data urodzenia jest wymagane!');
                // birthday.reportValidity('');
                correctForm = false;
                return;
            } else {
                document.getElementsByClassName("error")[6].innerHTML = "";
            }

            if (!validateRequiredField(country.value)) {
                document.getElementsByClassName("error")[7].innerHTML = "Pole Kraj jest wymagane!";
                // country.setCustomValidity('Pole Kraj jest wymagane!');
                // country.reportValidity('');
                correctForm = false;
                return;
            } else {
                document.getElementsByClassName("error")[7].innerHTML = "";
            }

            console.log(2023 - parseInt(document.getElementById("birthday").value.substring(0,4)));

            if(correctForm) {
                alert('Formularz wypełniono poprawnie!')
            }

            }
            
            // podpięcie funkcji validateForm() pod zdarzenie submit formularza
            const form = document.getElementById('form');
            form.addEventListener('submit', validateForm);

        </script>
    </body>
</html>